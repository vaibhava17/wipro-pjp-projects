QUESTION-1.
--------EMP_DETAILS----------
CREATE TABLE EMP_DETAILS (
EMPNO INT PRIMARY KEY,
FIRST_NAME VARCHAR2(30) NOT NULL,
LAST_NAME VARCHAR2(30) NOT NULL,
LODGE_NAME VARCHAR2(30) ,
FOREIGN KEY (LODGE_NAME) REFERENCES LODGE_DETAILS(LODGE_NAME) ON DELETE CASCADE
);
----------EMP_SKILL-----------
CREATE TABLE EMP_SKILL(
EMPNO INT,
SKILL VARCHAR2(30),
GRADE NUMBER(10),
PRIMARY KEY(EMPNO,SKILL),
FOREIGN KEY(EMPNO) REFERENCES EMP_DETAILS(EMPNO),
FOREIGN KEY(SKILL) REFERENCES SKILL_DETAILS(SKILL));

----------SKILL_DETAILS----------
CREATE TABLE SKILL_DETAILS(
SKILL VARCHAR2(30) PRIMARY KEY,
SKILL_Desc VARCHAR2(30)
);

-----------LODGE_DETAILS----------
CREATE TABLE LODGE_DETAILS(LODGE_NAME VARCHAR2(30) PRIMARY KEY,
LODGE_MANAGER VARCHAR2(30) NOT NULL,
LODGE_ADDRESS VARCHAR(30)
);

QUESTION-2.

-----------LODGE_DETAILS----------
INSERT INTO LODGE_DETAILS(LODGE_NAME,LODGE_MANAGER,LODGE_ADDRESS)
VALUES('Jessy Lodge','Rajan','Rakesh Nagar');
INSERT INTO LODGE_DETAILS(LODGE_NAME,LODGE_MANAGER,LODGE_ADDRESS)
VALUES('Rajesh Lodge','Rajani','Anna Nagar');
INSERT INTO LODGE_DETAILS(LODGE_NAME,LODGE_MANAGER,LODGE_ADDRESS)
VALUES('Gooday Lodge','John','Sea Road');

-----------EMP_DETAILS-----------
INSERT INTO EMP_DETAILS(EMPNO,FIRST_NAME,LAST_NAME,LODGE_NAME)
VALUES(101,'James','Jackson','Rajesh Lodge');
INSERT INTO EMP_DETAILS(EMPNO,FIRST_NAME,LAST_NAME,LODGE_NAME)
VALUES(102,'Kalpash','Raj','Gooday Lodge');
INSERT INTO EMP_DETAILS(EMPNO,FIRST_NAME,LAST_NAME,LODGE_NAME)
VALUES(103,'Jasmine','Joy','Jessy Lodge');

-----------SKILL_DETAILS----------
INSERT INTO SKILL_DETAILS(SKILL,SKILL_Desc) VALUES('Oracle SQL',
'Oracle Corporation');
INSERT INTO SKILL_DETAILS(SKILL,SKILL_Desc) VALUES('Dot Net',
'Microsoft');
INSERT INTO SKILL_DETAILS(SKILL,SKILL_Desc) VALUES('Sybase',
'SAP Corporation');

------------EMP_SKILL-------------
INSERT INTO EMP_SKILL(EMPNO,SKILL,GRADE) VALUES(101,'Oracle SQL',9);
INSERT INTO EMP_SKILL(EMPNO,SKILL,GRADE) VALUES(101,'Sybase',8);
INSERT INTO EMP_SKILL(EMPNO,SKILL,GRADE) VALUES(102,'Dot Net',9);
INSERT INTO EMP_SKILL(EMPNO,SKILL,GRADE) VALUES(103,'Oracle SQL',8);

QUESTION-3.
UPDATE EMP_DETAILS SET LODGE_NAME='Gooday Lodge' WHERE EMPNO=101;

QUESTION-4.
DELETE FROM LODGE_DETAILS WHERE LODGE_NAME IN(SELECT LODGE_NAME
FROM EMP_DETAILS WHERE EMPNO=103);

QUESTION-5.
a. SELECT EMPNO,INITCAP(SKILL) FROM EMP_SKILL WHERE SKILL IN ('Sybase');

b.SELECT E.FIRST_NAME,E1.SKILL,L.LODGE_MANAGER FROM EMP_DETAILS E JOIN
EMP_SKILL E1 ON E.EMPNO=E1.EMPNO JOIN LODGE_DETAILS L ON
E.LODGE_NAME=L.LODGE_NAME;

c.SELECT COUNT(*) "NO OF SKILL" FROM EMP_SKILL WHERE EMPNO=101;

d.SELECT FIRST_NAME FROM EMP_DETAILS WHERE EMPNO IN (SELECT EMPNO
FROM EMP_SKILL WHERE SKILL='Oracle SQL');

QUESTION-6.
CREATE VIEW EMP_VIEW AS
SELECT E.EMPNO,E.FIRST_NAME.S.SKILL,L.LODGE_MANAGER FROM
EMP_DETAILS E JOIN EMP_SKILL S ON E.EMPNO=S.EMPNO
JOIN LODGE_DETAILS L ON L.LODGE_NAME=E.LODGE_NAME;

QUESTION-7.
CREATE SYNONYM EMPV FOR EMP_VIEW;

QUESTION-8.
CREATE INDEX SKILL_INDEX ON EMP_SKILL(SKILL);

